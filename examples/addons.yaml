apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  finalizers:
  - resources-finalizer.argocd.argoproj.io
  labels:
    app.kubernetes.io/managed-by: Helm
  name: addons
  namespace: argocd
spec:
  destination:
    namespace: argocd
    server: https://kubernetes.default.svc
  project: default
  source:
    helm:
      values: |
        "account": "510522433898"
        "awsForFluentBit":
          "enable": true
          "namesapce": "logging"
          "logGroupName": "/aws002-preprod-dev-eks/worker-fluentbit-logs"
          "serviceAccountName": "aws-for-fluent-bit-sa"
        "clusterName": "aws002-preprod-dev-eks"
        "region": "ca-central-1"
    path: chart
    repoURL: https://github.com/bitbuy-infrastructure/argocd-infra-deployment.git
    targetRevision: BBSECAWS-199
  syncPolicy:
    automated:
      allowEmpty: false
      prune: true
      selfHeal: true
    retry:
      backoff:
        duration: 10s
        factor: 2
        maxDuration: 3m
    syncOptions:
    - Validate=false
    - CreateNamespace=true
    - PrunePropagationPolicy=foreground
    - PruneLast=true
